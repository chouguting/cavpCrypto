
#include "stdio.h"
#include "string.h"
#include "myEcdsa.h"
#include "mySha.h"
#include "myShake.h"
#include "myAes.h"
#include <string.h>
#include "myRsa.h"
#include <tomcrypt.h>
#include <tommath.h>
#include "utils.h"

// Visual Studio 有BUG，從Github上下載本專案後會無法編譯
// 解決方法：Windows偵錯工具右邊有個下拉選單，選擇cavpCrypto偵錯屬性，把C語言標準調成比較新的，就可以編譯了
// 很奇怪的是，如果你編譯成功後，再把C語言標準調回原本的，再編譯一次，也會成功 (很奇怪吧😶😶😶😶😶)

int main()
{
	/*
	//encrypt
	printf("encrypt\n");
	char* plaintext = "3FEB964D7DF5AF8364A263C3D7CFBE37";
	char* key = "6C35C021B948C7B93BFB016EE31AAEF79741CFD0874CD3913DDE8CA9BE28B9CB";
	char* initialVector = "B3941A16EF4591E0ABBA7E69E13C1445";
	char ciphertext[1024];
	aesEncrypt(AES_MODE_CTR, AES_KEY_SIZE_256, key, plaintext,initialVector, ciphertext);
	printf("ciphertext: %s\n", ciphertext);

	//decrypt
	printf("decrypt\n");
	char* ciphertext2 = "BD49295006250FFCA5100B6007A0EADE";
	char* key2 = "FFFFFF8000000000000000000000000000000000000000000000000000000000";
	char* initialVector2 = "00000000000000000000000000000000";
	char plaintext2[513];
	strcpy_s(plaintext2, 512, "");
	aesDecrypt(AES_MODE_CTR, AES_KEY_SIZE_256, key2, ciphertext2, initialVector2, plaintext2);
	printf("plaintext: %s\n", plaintext2);
	*/
	
	ecdsaKeyPair(ECDSA_CURVE_P521);
	
	char* qx = "0121FE52F15437C65AF19B15880D5D743B91AF758F5F90BEDDB252E0A5E8951D8E1EB77592944D2B21E958571B4B7FD3F15C1C79BF179379A0372109CC88A1C66362";
	char* qy = "005DDB68220242AAA80989986D8F12F70C418087CA6F9FF0E8073A07A91FCCAA1B777D4B13EE7F06EF6486D3F6FB0A1289271AA0B9C6E67DFFE5C78BC8B1FE513ED3";
	char* r = "00A22B7479EBFAD61C15DA8CEB3BB885ED9BB7113A2F78D2A7867D359D874A5198785CB35B9CB7D966C1D49FF7CAC7E7456091F23C07E0A46E3EBC1420311B2EDB0E";
	char* s = "0014B995309CB12B28CD3BD07CDDEEE1D196EFCDB07E22E0621F27A0BEE3D274106806CA699E68466538F4D06CF073475455FCBAFFC0A66143B252B18953BA688BF2";
	char* message = "2011CA8B0C00C5D89BE2862BC9FBC51384BB24A9E15A10E1A7148C4AD685AF4E0A0B53A453BE6E772F88BBAD39F97CA34AFFC7A6E7BCFA74B51D4A7A78F560568FC024459F10124C620B66DBCEC6FEF18F053F36DC3E0E2F51F3B4650AD08395638A7338EB0BA88A36A4E4F5EB4B676A83554BFB8AC4E102F80F50479B48F047";
	int result = ecdsaSignatureVerify(ECDSA_CURVE_P521, ECDSA_HASH_SHA2_256, qx, qy, r, s, message);
	printf("result: %d\n", result);  
	


	//MCT test
	/*char* mctPlaintext = "C9";
	char* mctKey = "C5D36D30F9D33D631FF5367693674949";
	char* mctInitialVector = "21FB30122A624B7A071BDD763D1F047A";*/

	//aesCfb128MCTEncrypt(AES_KEY_SIZE_192, mctPlaintext, mctKey, mctInitialVector);
	//aesCfb8MCTEncrypt(AES_KEY_SIZE_128, mctPlaintext, mctKey, mctInitialVector);


	//char* mctCiphertext = "AA4D5E000E28E3856E36110D80732E61";
	//char* mctKey2 = "4AFC928203A640E26DC0752E78484D4349B946334C4C77297EDEA3A8FE3C6519";
	//char * mctInitialVector2 = "3F3BEAC49657F44FBE44B582B4ECEB61";

	//aesCfb128MCTDecrypt(AES_KEY_SIZE_256, mctCiphertext, mctKey2, mctInitialVector2);
	
	
}
