
#include "stdio.h"
#include "string.h"
#include "myEcdsa.h"


// Visual Studio 有BUG，從Github上下載本專案後會無法編譯
// 解決方法：Windows偵錯工具右邊有個下拉選單，選擇cavpCrypto偵錯屬性，把C語言標準調成比較新的，就可以編譯了
// 很奇怪的是，如果你編譯成功後，再把C語言標準調回原本的，再編譯一次，也會成功 (很奇怪吧😶😶😶😶😶)

int main()
{
	char* message = "7E6C382C0D6DEF2B180B4417995AF4D25151B84E614FEDC4D7931DCB71B4331577ED61804A5F8D531D5C01FBED2E958F2029BBD1053FB9DFED828C9BC00D87190632462EEA14FB0C23BE8E1A2EDB47632FDDD9F9CD3A47BD1B4B95466CB111AC762FD63492C46DF923890C4CFCD42B83C8F84CD2B9FE49DC66D8F2570E1F952F";
	char* qx = "0091699D14832AFB5189F9759174654CB4881E2E9E2C2FA0CBA266B3837C100D17DCB0EB302683FDE071A682B4211A052D752D5165670DC294A017C6AA9944E3FD22";
	char* qy = "21E8089C5D826CEBE5653329040EA340E534C0819A108C061F01101DE0A7AD31FB23F02641DFD80724C3BCD9F81E4E0F53E08046116C520E689CFE7638AC3911F3";
	char* d = "012FC9BC24B7733246456C5EB6F8A45AA9CAB7889AAB5B11B5751C46F1A476B5DF777E65D11600FB966B2D139C96124DD0DE4655D789E62B3B9A64D084FAE05A5DFF";
	int keypairCurve = ECDSA_CURVE_P521;
	//ecdsaKeyPair(keypairCurve);
	ecdsaSignatureGenerate(keypairCurve, ECDSA_HASH_SHAKE256, d, message);

	char* r = "E50315FEFB872D5C2CBBB149111897A3868DCEF8CB65B2424E0CBA4446A45A8EB90C4D9C025456A5BA8A1BED11AC67FA0879A18584935CF4C8409D1DB71F10F44D";
	char* s = "193617EAFC1553E3EDEDB456E1311103131925F96DAC826BA3C2D5E43264F03BCE629AC43974D91FABE305C48A134E99E246FD9F4C335C0A80A71A9B2E6F3AFFA9A";
 
	ecdsaSignatureVerify(keypairCurve, ECDSA_HASH_SHAKE256, qx, qy, r, s, message);
	/*
	char bytes[32];
	char* hex = "4A5B";
	int len;
	hex_to_bytes(hex, bytes, &len);
	printf("len = %d\n", len);
	for (int i = 0; i < len; i++)
	{
		printf("%02X", bytes[i]);
	}
	printf("\n");
	for (int i = 0; i < len; i++)
	{
		printf("%d ", bytes[i]);
	}
	char hex2[50];
	bytes_to_hex(bytes, len, hex2);
	printf("\nhex2 = %s\n", hex2);

	return 0;*/
}

